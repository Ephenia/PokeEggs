"use strict";var __awaiter=this&&this.__awaiter||function(e,o,n,a){return new(n||(n=Promise))((function(t,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function c(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?t(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(i,c)}l((a=a.apply(e,o||[])).next())}))};localforage.config({driver:localforage.INDEXEDDB,name:"PokÃ©Eggs",version:1,size:1e8,storeName:"keyvaluepairs",description:""});let preventSave=!1,clearSave=!1;function preserveOnSave(){return __awaiter(this,void 0,void 0,(function*(){for(const e in player.buffHandler)player.buffHandler[e].buffPause=Date.now();pauseEggTimer(!0)}))}function hasSave(){return __awaiter(this,void 0,void 0,(function*(){try{return null!==(yield localforage.getItem("PE_Player"))}catch(e){console.log(e)}}))}function createSave(){return __awaiter(this,void 0,void 0,(function*(){localforage.setItem("PE_Player",player).then((function(e){console.log(e),colorLog("Saved game!","info"),preserveOnSave()})).catch((function(e){console.log(e)}))}))}function loadSave(){return __awaiter(this,void 0,void 0,(function*(){localforage.getItem("PE_Player").then((function(e){console.log(e),colorLog("Loaded save!","info"),player=e,setTimeout((()=>{loadMain()}),0)})).catch((function(e){console.log(e)}))}))}function deleteSave(){localforage.clear().then((function(){colorLog("Save data cleared!","success"),clearSave=!0,location.reload()})).catch((function(e){console.log(e)}))}window.addEventListener("beforeunload",(function(e){return __awaiter(this,void 0,void 0,(function*(){clearSave||preventSave||(yield preserveOnSave(),yield createSave())}))}),!1);