"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,o){function d(e){try{r(a.next(e))}catch(e){o(e)}}function c(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,c)}r((a=a.apply(e,t||[])).next())}))};const pkmnBoxCont=document.getElementById("pkmn-box-cont"),leadPokeCont=document.getElementById("lead-pkmn"),pokeRadarCont=document.getElementById("poke-radar-cont");let pkmnBoxView,player={leadPoke:{},party:{},items:{},pokemonBox:{},buffHandler:{},radarHandler:{active:!1,chain:0,lastHatch:null,hatchNormal:0,hatchShiny:0},eggHandler:{},prefs:{nav:0,bag:0,debug:!1},flags:{kantoStarter:!1,highestRegion:0},notifyTrack:{},statistics:{}};function initialize(){return __awaiter(this,void 0,void 0,(function*(){(yield hasSave())?yield loadSave():(yield newLead(),yield newParty(),yield newEggHandler(),yield createSave(),loadMain())}))}function loadMain(){console.log(player.party),buildNav(),renderLead(),createParty(),createPokeBox(),createItemBag(),renderMain(player.prefs.nav),changeItemBag(player.prefs.bag),resumeBuffs(),resumeEggs(),resumeNotify(),player.flags.kantoStarter||openModal("starterselect","Select Starter"),setInterval((function(){}),6e4)}function renderMain(e){const t=document.querySelectorAll("[view-index]");if(navOptions[e].cond()){for(const e of t)e.setAttribute("style","display: none");t[e].setAttribute("style","display:flex"),player.prefs.nav=e}navOptions[e].nav(),navSelect()}function renderLead(){disposeElement(leadPokeCont);const e=new DocumentFragment,t=player.leadPoke,n=document.createElement("div");if(null!==t.isEgg){const e=document.createElement("img");e.src=`assets/pkmnicon/${t.isShiny?"shiny":"normal"}/${t.sprite}.png`,n.appendChild(e),leadPokeCont.classList.add("lead-pkmn-active")}else n.textContent="Lead is empty.",leadPokeCont.classList.remove("lead-pkmn-active");e.appendChild(n),leadPokeCont.appendChild(e)}function createParty(){const e=new DocumentFragment,t=Object.keys(player.party).length;for(let n=0;n<t;n++){const t=document.createElement("div");t.classList.add("party-slot","main-bg"),t.setAttribute("data-src",`${n}`),t.setAttribute("pkmn-menu","party"),e.appendChild(t)}partyCont.appendChild(e),partySlots=document.getElementsByClassName("party-slot")}function createPokeBox(){const e=new DocumentFragment,t=document.createElement("div");t.id="pkmn-box-view",t.classList.add("main-border"),e.appendChild(t),pkmnBoxCont.appendChild(e),pkmnBoxView=document.getElementById("pkmn-box-view")}function createItemBag(){const e=new DocumentFragment,t=document.createElement("div");t.id="item-bag-tab-row";const n=document.createElement("div");n.id="item-bag-view",n.classList.add("main-border");for(const e in invNames){const n=invNames[e][0],a=document.createElement("div");a.setAttribute("tab-src",e),a.classList.add("item-bag-tab-cont"),a.addEventListener("click",(()=>{player.prefs.bag!==+e&&changeItemBag(+e)}));const i=document.createElement("img");i.classList.add("item-bag-tab"),i.src=`assets/bag/${n}.png`,a.appendChild(i),t.appendChild(a)}e.appendChild(t),e.appendChild(n),itemBagCont.appendChild(e),itemBagView=document.getElementById("item-bag-view")}function newLead(){return __awaiter(this,void 0,void 0,(function*(){player.leadPoke=Object.assign(emptyMember(),player.leadPoke)}))}function newParty(){return __awaiter(this,void 0,void 0,(function*(){let e=new Object;for(let t=0;t<6;t++)e[t]=Object.assign(emptyMember(),e[t]);player.party=e}))}function newEggHandler(){return __awaiter(this,void 0,void 0,(function*(){player.eggHandler=new Array(6).fill(null,0)}))}function renderPokeBox(){if(isHidden(pkmnBoxCont))return;disposeElement(pkmnBoxView);const e=document.createDocumentFragment();if(0!==Object.keys(player.pokemonBox).length){pkmnBoxView.classList.remove("empty-box");for(const t in player.pokemonBox){const n=player.pokemonBox[t],a=document.createElement("div");a.classList.add("pkmn-box-slot"),a.setAttribute("data-src",t),a.setAttribute("pkmn-menu","box");const i=document.createElement("img");i.src=n.isEgg?"assets/pkmnicon/egg.png":`assets/pkmnicon/${n.isShiny?"shiny":"normal"}/${n.sprite}.png`,i.setAttribute("loading","lazy"),a.appendChild(i),e.appendChild(a)}}else pkmnBoxView.classList.add("empty-box"),e.textContent="Your Pokémon Box is empty.";pkmnBoxView.appendChild(e)}function advanceChain(e,t){const n=player.radarHandler;if(n.active){const a=document.querySelector('[buff-src="408"]');function i(){n.active=!1,delete player.buffHandler[408],a.remove()}0===n.chain||n.lastHatch===e?(n.lastHatch=e,n.chain++,buffCounter(408,n.chain),t?(n.hatchShiny++,i()):n.hatchNormal++):(n.chain=0,n.lastHatch=null,n.hatchNormal=0,n.hatchShiny=0,i())}renderPokeRadar()}function chainOdds(e){const t=Math.min(40,e);let n=4096;return t<30?n=16+t+0:t<=35?n=20+t+0:36==t?n=30+t+0:e>=37&&(n=82<<t-37),Math.round(65536/n)}function renderPokeRadar(){if(isHidden(pokeRadarCont))return;disposeElement(pokeRadarCont);const e=document.createDocumentFragment(),t=player.radarHandler,n=document.createElement("div");if(n.id="poke-radar-state",n.innerHTML=`The Poké Radar is currently <b class="${t.active?"active-text":"inactive-text"}">${t.active?"ACTIVE":"INACTIVE"}</b>.`,e.appendChild(n),!t.active){const t=document.createElement("div");t.id="poke-radar-cost";checkItemAmnt(593);t.innerHTML=`<div>${itemImg(593)}${checkItemAmnt(593).toLocaleString()} / 50</div>`;const n=document.createElement("button");n.textContent="Turn On",n.addEventListener("click",(()=>{createBuff(408),renderPokeRadar()})),t.appendChild(n),e.appendChild(t)}const a=document.createElement("div");a.id="poke-radar-chain-info",a.classList.add("main-border");const i=document.createElement("div"),o=document.createElement("img"),d=document.createElement("div"),c=document.createElement("img");null!==t.lastHatch?(o.src=`assets/pkmn/normal/${pkmnData[t.lastHatch].name}.png`,c.src=`assets/pkmn/shiny/${pkmnData[t.lastHatch].name}.png`):(o.src="assets/pkmnicon/unknown-gen5.png",c.src="assets/pkmnicon/unknown-gen5.png"),i.appendChild(o),d.appendChild(c);const r=document.createElement("div");r.textContent=`${t.hatchNormal.toLocaleString()}`,i.appendChild(r);const s=document.createElement("div");s.classList.add("shiny-symbol"),s.textContent=`${t.hatchShiny.toLocaleString()}`,d.appendChild(s),a.appendChild(i),a.appendChild(d),e.appendChild(a);const l=document.createElement("div");l.id="poke-radar-chain-len",l.textContent=`Chain: ${t.chain.toLocaleString("en")}`,e.appendChild(l);const m=document.createElement("div");m.textContent=`✨ Shiny Odds: ${fracToPerc(chainOdds(t.chain))}%`,e.appendChild(m),pokeRadarCont.appendChild(e)}initialize(),document.addEventListener("click",(e=>{e.target;pkmnMenu.style.display="none"}));